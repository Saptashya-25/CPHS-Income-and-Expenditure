// Loop through each file in the list
foreach data_inc in "household_income_20140131_MS_rev" "household_income_20140228_MS_rev" "household_income_20140331_MS_rev" "household_income_20140430_MS_rev" "household_income_20140531_MS_rev" "household_income_20140630_MS_rev" "household_income_20140731_MS_rev" "household_income_20140831_MS_rev" "household_income_20140930_MS_rev" "household_income_20141031_MS_rev" "household_income_20141130_MS_rev" "household_income_20141231_MS_rev" "household_income_20150131_MS_rev" "household_income_20150228_MS_rev" "household_income_20150331_MS_rev" "household_income_20150430_MS_rev" "household_income_20150531_MS_rev" "household_income_20150630_MS_rev" "household_income_20150731_MS_rev" "household_income_20150831_MS_rev" "household_income_20150930_MS_rev" "household_income_20151031_MS_rev" "household_income_20151130_MS_rev" "household_income_20151231_MS_rev" "household_income_20160131_MS_rev" "household_income_20160229_MS_rev" "household_income_20160331_MS_rev" "household_income_20160430_MS_rev" "household_income_20160531_MS_rev" "household_income_20160630_MS_rev" "household_income_20160731_MS_rev" "household_income_20160831_MS_rev" "household_income_20160930_MS_rev" "household_income_20161031_MS_rev" "household_income_20161130_MS_rev" "household_income_20161231_MS_rev" "household_income_20170131_MS_rev" "household_income_20170228_MS_rev" "household_income_20170331_MS_rev" "household_income_20170430_MS_rev" "household_income_20170531_MS_rev" "household_income_20170630_MS_rev" "household_income_20170731_MS_rev" "household_income_20170831_MS_rev" "household_income_20170930_MS_rev" "household_income_20171031_MS_rev" "household_income_20171130_MS_rev" "household_income_20171231_MS_rev" "household_income_20180131_MS_rev" "household_income_20180228_MS_rev" "household_income_20180331_MS_rev" "household_income_20180430_MS_rev" "household_income_20180531_MS_rev" "household_income_20180630_MS_rev" "household_income_20180731_MS_rev" "household_income_20180831_MS_rev" "household_income_20180930_MS_rev" "household_income_20181031_MS_rev" "household_income_20181130_MS_rev" "household_income_20181231_MS_rev" "household_income_20190131_MS_rev" "household_income_20190228_MS_rev" "household_income_20190331_MS_rev" "household_income_20190430_MS_rev" "household_income_20190531_MS_rev" "household_income_20190630_MS_rev" "household_income_20190731_MS_rev" "household_income_20190831_MS_rev" "household_income_20190930_MS_rev" "household_income_20191031_MS_rev" "household_income_20191130_MS_rev" "household_income_20191231_MS_rev" "household_income_20200131_MS_rev" "household_income_20200229_MS_rev" "household_income_20200331_MS_rev" "household_income_20200430_MS_rev" "household_income_20200531_MS_rev" "household_income_20200630_MS_rev" "household_income_20200731_MS_rev" "household_income_20200831_MS_rev" "household_income_20200930_MS_rev" "household_income_20201031_MS_rev" "household_income_20201130_MS_rev" "household_income_20201231_MS_rev" "household_income_20210131_MS_rev" "household_income_20210228_MS_rev" "household_income_20210331_MS_rev" "household_income_20210430_MS_rev" "household_income_20210531_MS_rev" "household_income_20210630_MS_rev" "household_income_20210731_MS_rev" "household_income_20210831_MS_rev" "household_income_20210930_MS_rev" "household_income_20211031_MS_rev" "household_income_20211130_MS_rev" "household_income_20211231_MS_rev" "household_income_20220131_MS_rev" "household_income_20220228_MS_rev" "household_income_20220331_MS_rev" "household_income_20220430_MS_rev" "household_income_20220531_MS_rev" "household_income_20220630_MS_rev" "household_income_20220731_MS_rev" "household_income_20220831_MS_rev" "household_income_20220930_MS_rev" "household_income_20221031_MS_rev" "household_income_20221130_MS_rev" "household_income_20221231_MS_rev" "household_income_20230131_MS_rev" "household_income_20230228_MS_rev" "household_income_20230331_MS_rev" "household_income_20230430_MS_rev" "household_income_20230531_MS_rev" "household_income_20230630_MS_rev" "household_income_20230731_MS_rev" "household_income_20230831_MS_rev" "household_income_20230930_MS_rev" "household_income_20231031_MS_rev" "household_income_20231130_MS_rev" "household_income_20231231_MS_rev"{
    // Import the CSV file using the full path
    import delimited "$cphs/Income/CSV_inc/`data_inc'.csv", clear

    // Save the data as a .dta file using the full path
    save "$cphs/Income/DTA_inc/`data_inc'.dta", replace
}






// Loop through each file in the list
foreach data_exp in "consumption_pyramids_20140131_MS_rev" "consumption_pyramids_20140228_MS_rev" "consumption_pyramids_20140331_MS_rev" "consumption_pyramids_20140430_MS_rev" "consumption_pyramids_20140531_MS_rev" "consumption_pyramids_20140630_MS_rev" "consumption_pyramids_20140731_MS_rev" "consumption_pyramids_20140831_MS_rev" "consumption_pyramids_20140930_MS_rev" "consumption_pyramids_20141031_MS_rev" "consumption_pyramids_20141130_MS_rev" "consumption_pyramids_20141231_MS_rev" "consumption_pyramids_20150131_MS_rev" "consumption_pyramids_20150228_MS_rev" "consumption_pyramids_20150331_MS_rev" "consumption_pyramids_20150430_MS_rev" "consumption_pyramids_20150531_MS_rev" "consumption_pyramids_20150630_MS_rev" "consumption_pyramids_20150731_MS_rev" "consumption_pyramids_20150831_MS_rev" "consumption_pyramids_20150930_MS_rev" "consumption_pyramids_20151031_MS_rev" "consumption_pyramids_20151130_MS_rev" "consumption_pyramids_20151231_MS_rev" "consumption_pyramids_20160131_MS_rev" "consumption_pyramids_20160229_MS_rev" "consumption_pyramids_20160331_MS_rev" "consumption_pyramids_20160430_MS_rev" "consumption_pyramids_20160531_MS_rev" "consumption_pyramids_20160630_MS_rev" "consumption_pyramids_20160731_MS_rev" "consumption_pyramids_20160831_MS_rev" "consumption_pyramids_20160930_MS_rev" "consumption_pyramids_20161031_MS_rev" "consumption_pyramids_20161130_MS_rev" "consumption_pyramids_20161231_MS_rev" "consumption_pyramids_20170131_MS_rev" "consumption_pyramids_20170228_MS_rev" "consumption_pyramids_20170331_MS_rev" "consumption_pyramids_20170430_MS_rev" "consumption_pyramids_20170531_MS_rev" "consumption_pyramids_20170630_MS_rev" "consumption_pyramids_20170731_MS_rev" "consumption_pyramids_20170831_MS_rev" "consumption_pyramids_20170930_MS_rev" "consumption_pyramids_20171031_MS_rev" "consumption_pyramids_20171130_MS_rev" "consumption_pyramids_20171231_MS_rev" "consumption_pyramids_20180131_MS_rev" "consumption_pyramids_20180228_MS_rev" "consumption_pyramids_20180331_MS_rev" "consumption_pyramids_20180430_MS_rev" "consumption_pyramids_20180531_MS_rev" "consumption_pyramids_20180630_MS_rev" "consumption_pyramids_20180731_MS_rev" "consumption_pyramids_20180831_MS_rev" "consumption_pyramids_20180930_MS_rev" "consumption_pyramids_20181031_MS_rev" "consumption_pyramids_20181130_MS_rev" "consumption_pyramids_20181231_MS_rev" "consumption_pyramids_20190131_MS_rev" "consumption_pyramids_20190228_MS_rev" "consumption_pyramids_20190331_MS_rev" "consumption_pyramids_20190430_MS_rev" "consumption_pyramids_20190531_MS_rev" "consumption_pyramids_20190630_MS_rev" "consumption_pyramids_20190731_MS_rev" "consumption_pyramids_20190831_MS_rev" "consumption_pyramids_20190930_MS_rev" "consumption_pyramids_20191031_MS_rev" "consumption_pyramids_20191130_MS_rev" "consumption_pyramids_20191231_MS_rev" "consumption_pyramids_20200131_MS_rev" "consumption_pyramids_20200229_MS_rev" "consumption_pyramids_20200331_MS_rev" "consumption_pyramids_20200430_MS_rev" "consumption_pyramids_20200531_MS_rev" "consumption_pyramids_20200630_MS_rev" "consumption_pyramids_20200731_MS_rev" "consumption_pyramids_20200831_MS_rev" "consumption_pyramids_20200930_MS_rev" "consumption_pyramids_20201031_MS_rev" "consumption_pyramids_20201130_MS_rev" "consumption_pyramids_20201231_MS_rev" "consumption_pyramids_20210131_MS_rev" "consumption_pyramids_20210228_MS_rev" "consumption_pyramids_20210331_MS_rev" "consumption_pyramids_20210430_MS_rev" "consumption_pyramids_20210531_MS_rev" "consumption_pyramids_20210630_MS_rev" "consumption_pyramids_20210731_MS_rev" "consumption_pyramids_20210831_MS_rev" "consumption_pyramids_20210930_MS_rev" "consumption_pyramids_20211031_MS_rev" "consumption_pyramids_20211130_MS_rev" "consumption_pyramids_20211231_MS_rev" "consumption_pyramids_20220131_MS_rev" "consumption_pyramids_20220228_MS_rev" "consumption_pyramids_20220331_MS_rev" "consumption_pyramids_20220430_MS_rev" "consumption_pyramids_20220531_MS_rev" "consumption_pyramids_20220630_MS_rev" "consumption_pyramids_20220731_MS_rev" "consumption_pyramids_20220831_MS_rev" "consumption_pyramids_20220930_MS_rev" "consumption_pyramids_20221031_MS_rev" "consumption_pyramids_20221130_MS_rev" "consumption_pyramids_20221231_MS_rev" "consumption_pyramids_20230131_MS_rev" "consumption_pyramids_20230228_MS_rev" "consumption_pyramids_20230331_MS_rev" "consumption_pyramids_20230430_MS_rev" "consumption_pyramids_20230531_MS_rev" "consumption_pyramids_20230630_MS_rev" "consumption_pyramids_20230731_MS_rev" "consumption_pyramids_20230831_MS_rev" "consumption_pyramids_20230930_MS_rev" "consumption_pyramids_20231031_MS_rev" "consumption_pyramids_20231130_MS_rev" "consumption_pyramids_20231231_MS_rev"{
    // Import the CSV file using the full path
    import delimited "$cphs/Expenditure/CSV_exp/`data_exp'.csv", clear

    // Save the data as a .dta file using the full path
    save "$cphs/Expenditure/DTA_exp/`data_exp'.dta", replace
}



//Append all Income//
use "$cphs\Income\DTA_inc\household_income_20140131_MS_rev.dta", clear
foreach data_inc in "household_income_20140228_MS_rev" "household_income_20140331_MS_rev" "household_income_20140430_MS_rev" "household_income_20140531_MS_rev" "household_income_20140630_MS_rev" "household_income_20140731_MS_rev" "household_income_20140831_MS_rev" "household_income_20140930_MS_rev" "household_income_20141031_MS_rev" "household_income_20141130_MS_rev" "household_income_20141231_MS_rev" "household_income_20150131_MS_rev" "household_income_20150228_MS_rev" "household_income_20150331_MS_rev" "household_income_20150430_MS_rev" "household_income_20150531_MS_rev" "household_income_20150630_MS_rev" "household_income_20150731_MS_rev" "household_income_20150831_MS_rev" "household_income_20150930_MS_rev" "household_income_20151031_MS_rev" "household_income_20151130_MS_rev" "household_income_20151231_MS_rev" "household_income_20160131_MS_rev" "household_income_20160229_MS_rev" "household_income_20160331_MS_rev" "household_income_20160430_MS_rev" "household_income_20160531_MS_rev" "household_income_20160630_MS_rev" "household_income_20160731_MS_rev" "household_income_20160831_MS_rev" "household_income_20160930_MS_rev" "household_income_20161031_MS_rev" "household_income_20161130_MS_rev" "household_income_20161231_MS_rev" "household_income_20170131_MS_rev" "household_income_20170228_MS_rev" "household_income_20170331_MS_rev" "household_income_20170430_MS_rev" "household_income_20170531_MS_rev" "household_income_20170630_MS_rev" "household_income_20170731_MS_rev" "household_income_20170831_MS_rev" "household_income_20170930_MS_rev" "household_income_20171031_MS_rev" "household_income_20171130_MS_rev" "household_income_20171231_MS_rev" "household_income_20180131_MS_rev" "household_income_20180228_MS_rev" "household_income_20180331_MS_rev" "household_income_20180430_MS_rev" "household_income_20180531_MS_rev" "household_income_20180630_MS_rev" "household_income_20180731_MS_rev" "household_income_20180831_MS_rev" "household_income_20180930_MS_rev" "household_income_20181031_MS_rev" "household_income_20181130_MS_rev" "household_income_20181231_MS_rev" "household_income_20190131_MS_rev" "household_income_20190228_MS_rev" "household_income_20190331_MS_rev" "household_income_20190430_MS_rev" "household_income_20190531_MS_rev" "household_income_20190630_MS_rev" "household_income_20190731_MS_rev" "household_income_20190831_MS_rev" "household_income_20190930_MS_rev" "household_income_20191031_MS_rev" "household_income_20191130_MS_rev" "household_income_20191231_MS_rev" "household_income_20200131_MS_rev" "household_income_20200229_MS_rev" "household_income_20200331_MS_rev" "household_income_20200430_MS_rev" "household_income_20200531_MS_rev" "household_income_20200630_MS_rev" "household_income_20200731_MS_rev" "household_income_20200831_MS_rev" "household_income_20200930_MS_rev" "household_income_20201031_MS_rev" "household_income_20201130_MS_rev" "household_income_20201231_MS_rev" "household_income_20210131_MS_rev" "household_income_20210228_MS_rev" "household_income_20210331_MS_rev" "household_income_20210430_MS_rev" "household_income_20210531_MS_rev" "household_income_20210630_MS_rev" "household_income_20210731_MS_rev" "household_income_20210831_MS_rev" "household_income_20210930_MS_rev" "household_income_20211031_MS_rev" "household_income_20211130_MS_rev" "household_income_20211231_MS_rev" "household_income_20220131_MS_rev" "household_income_20220228_MS_rev" "household_income_20220331_MS_rev" "household_income_20220430_MS_rev" "household_income_20220531_MS_rev" "household_income_20220630_MS_rev" "household_income_20220731_MS_rev" "household_income_20220831_MS_rev" "household_income_20220930_MS_rev" "household_income_20221031_MS_rev" "household_income_20221130_MS_rev" "household_income_20221231_MS_rev" "household_income_20230131_MS_rev" "household_income_20230228_MS_rev" "household_income_20230331_MS_rev" "household_income_20230430_MS_rev" "household_income_20230531_MS_rev" "household_income_20230630_MS_rev" "household_income_20230731_MS_rev" "household_income_20230831_MS_rev" "household_income_20230930_MS_rev" "household_income_20231031_MS_rev" "household_income_20231130_MS_rev" "household_income_20231231_MS_rev"{
    //Append the rest
	append using "$cphs/Income/DTA_inc/`data_inc'.dta"

    // Erase existing dta
    erase "$cphs/Income/DTA_inc/`data_inc'.dta"
}

save "$cphs/Income/DTA_inc/all_inc_appended.dta"
erase "$cphs\Income\DTA_inc\household_income_20140131_MS_rev.dta"


//Append Expenditure//
use "$cphs/Expenditure/DTA_exp/consumption_pyramids_20140131_MS_rev.dta", clear
foreach data_exp in "consumption_pyramids_20140228_MS_rev" "consumption_pyramids_20140331_MS_rev" "consumption_pyramids_20140430_MS_rev" "consumption_pyramids_20140531_MS_rev" "consumption_pyramids_20140630_MS_rev" "consumption_pyramids_20140731_MS_rev" "consumption_pyramids_20140831_MS_rev" "consumption_pyramids_20140930_MS_rev" "consumption_pyramids_20141031_MS_rev" "consumption_pyramids_20141130_MS_rev" "consumption_pyramids_20141231_MS_rev" "consumption_pyramids_20150131_MS_rev" "consumption_pyramids_20150228_MS_rev" "consumption_pyramids_20150331_MS_rev" "consumption_pyramids_20150430_MS_rev" "consumption_pyramids_20150531_MS_rev" "consumption_pyramids_20150630_MS_rev" "consumption_pyramids_20150731_MS_rev" "consumption_pyramids_20150831_MS_rev" "consumption_pyramids_20150930_MS_rev" "consumption_pyramids_20151031_MS_rev" "consumption_pyramids_20151130_MS_rev" "consumption_pyramids_20151231_MS_rev" "consumption_pyramids_20160131_MS_rev" "consumption_pyramids_20160229_MS_rev" "consumption_pyramids_20160331_MS_rev" "consumption_pyramids_20160430_MS_rev" "consumption_pyramids_20160531_MS_rev" "consumption_pyramids_20160630_MS_rev" "consumption_pyramids_20160731_MS_rev" "consumption_pyramids_20160831_MS_rev" "consumption_pyramids_20160930_MS_rev" "consumption_pyramids_20161031_MS_rev" "consumption_pyramids_20161130_MS_rev" "consumption_pyramids_20161231_MS_rev" "consumption_pyramids_20170131_MS_rev" "consumption_pyramids_20170228_MS_rev" "consumption_pyramids_20170331_MS_rev" "consumption_pyramids_20170430_MS_rev" "consumption_pyramids_20170531_MS_rev" "consumption_pyramids_20170630_MS_rev" "consumption_pyramids_20170731_MS_rev" "consumption_pyramids_20170831_MS_rev" "consumption_pyramids_20170930_MS_rev" "consumption_pyramids_20171031_MS_rev" "consumption_pyramids_20171130_MS_rev" "consumption_pyramids_20171231_MS_rev" "consumption_pyramids_20180131_MS_rev" "consumption_pyramids_20180228_MS_rev" "consumption_pyramids_20180331_MS_rev" "consumption_pyramids_20180430_MS_rev" "consumption_pyramids_20180531_MS_rev" "consumption_pyramids_20180630_MS_rev" "consumption_pyramids_20180731_MS_rev" "consumption_pyramids_20180831_MS_rev" "consumption_pyramids_20180930_MS_rev" "consumption_pyramids_20181031_MS_rev" "consumption_pyramids_20181130_MS_rev" "consumption_pyramids_20181231_MS_rev" "consumption_pyramids_20190131_MS_rev" "consumption_pyramids_20190228_MS_rev" "consumption_pyramids_20190331_MS_rev" "consumption_pyramids_20190430_MS_rev" "consumption_pyramids_20190531_MS_rev" "consumption_pyramids_20190630_MS_rev" "consumption_pyramids_20190731_MS_rev" "consumption_pyramids_20190831_MS_rev" "consumption_pyramids_20190930_MS_rev" "consumption_pyramids_20191031_MS_rev" "consumption_pyramids_20191130_MS_rev" "consumption_pyramids_20191231_MS_rev" "consumption_pyramids_20200131_MS_rev" "consumption_pyramids_20200229_MS_rev" "consumption_pyramids_20200331_MS_rev" "consumption_pyramids_20200430_MS_rev" "consumption_pyramids_20200531_MS_rev" "consumption_pyramids_20200630_MS_rev" "consumption_pyramids_20200731_MS_rev" "consumption_pyramids_20200831_MS_rev" "consumption_pyramids_20200930_MS_rev" "consumption_pyramids_20201031_MS_rev" "consumption_pyramids_20201130_MS_rev" "consumption_pyramids_20201231_MS_rev" "consumption_pyramids_20210131_MS_rev" "consumption_pyramids_20210228_MS_rev" "consumption_pyramids_20210331_MS_rev" "consumption_pyramids_20210430_MS_rev" "consumption_pyramids_20210531_MS_rev" "consumption_pyramids_20210630_MS_rev" "consumption_pyramids_20210731_MS_rev" "consumption_pyramids_20210831_MS_rev" "consumption_pyramids_20210930_MS_rev" "consumption_pyramids_20211031_MS_rev" "consumption_pyramids_20211130_MS_rev" "consumption_pyramids_20211231_MS_rev" "consumption_pyramids_20220131_MS_rev" "consumption_pyramids_20220228_MS_rev" "consumption_pyramids_20220331_MS_rev" "consumption_pyramids_20220430_MS_rev" "consumption_pyramids_20220531_MS_rev" "consumption_pyramids_20220630_MS_rev" "consumption_pyramids_20220731_MS_rev" "consumption_pyramids_20220831_MS_rev" "consumption_pyramids_20220930_MS_rev" "consumption_pyramids_20221031_MS_rev" "consumption_pyramids_20221130_MS_rev" "consumption_pyramids_20221231_MS_rev" "consumption_pyramids_20230131_MS_rev" "consumption_pyramids_20230228_MS_rev" "consumption_pyramids_20230331_MS_rev" "consumption_pyramids_20230430_MS_rev" "consumption_pyramids_20230531_MS_rev" "consumption_pyramids_20230630_MS_rev" "consumption_pyramids_20230731_MS_rev" "consumption_pyramids_20230831_MS_rev" "consumption_pyramids_20230930_MS_rev" "consumption_pyramids_20231031_MS_rev" "consumption_pyramids_20231130_MS_rev" "consumption_pyramids_20231231_MS_rev"{
    // Import the CSV file using the full path
    append using "$cphs/Expenditure/DTA_exp/`data_exp'.dta"

    // Save the data as a .dta file using the full path
    erase "$cphs/Expenditure/DTA_exp/`data_exp'.dta"
}

save "$cphs\Expenditure\DTA_exp\all_exp_appended.dta"
erase "$cphs/Expenditure/DTA_exp/consumption_pyramids_20140131_MS_rev.dta"


//Keep only for bihar and up and for the months needed for income//
use "$cphs/Income/DTA_inc/all_inc_appended.dta", clear
gen year = substr(month, 5,.)
destring year, replace
gen mnth = substr(month,1,3)
drop month
gen month=.
replace month = 1 if mnth == "Jan" 
replace month = 2 if mnth == "Feb" 
replace month = 3 if mnth == "Mar" 
replace month = 4 if mnth == "Apr" 
replace month = 5 if mnth == "May" 
replace month = 6 if mnth == "Jun" 
replace month = 7 if mnth == "Jul" 
replace month = 8 if mnth == "Aug" 
replace month = 9 if mnth == "Sep" 
replace month = 10 if mnth == "Oct" 
replace month = 11 if mnth == "Nov" 
replace month = 12 if mnth == "Dec" 
rename mnth Month 
*tostring year month, replace
gen mnth = ym(year, month)
gen date_flag = mnth
format mnth %tmMon
foreach var in tot_inc inc_of_all_mems_frm_all_srcs inc_of_all_mems_frm_wages inc_of_hh_frm_all_srcs inc_of_hh_frm_rent inc_of_hh_frm_self_prodn inc_of_hh_frm_pvt_trf inc_of_hh_frm_biz_profit inc_of_all_mems_frm_pension inc_of_all_mems_frm_dividend inc_of_all_mems_frm_interest inc_of_hh_frm_govt_trf inc_of_hh_frm_asset_sale inc_of_hh_frm_gambling inc_of_all_mems_frm_fd_pf_ins inc_of_hh_frm_in_kind_govt_trf inc_of_hh_frm_ngo_trf{
	replace `var' = . if `var'<0
}

collapse (sum) tot_inc inc_of_all_mems_frm_all_srcs inc_of_all_mems_frm_wages inc_of_hh_frm_all_srcs inc_of_hh_frm_rent inc_of_hh_frm_self_prodn inc_of_hh_frm_pvt_trf inc_of_hh_frm_biz_profit inc_of_all_mems_frm_pension inc_of_all_mems_frm_dividend inc_of_all_mems_frm_interest inc_of_hh_frm_govt_trf inc_of_hh_frm_asset_sale inc_of_hh_frm_gambling inc_of_all_mems_frm_fd_pf_ins inc_of_hh_frm_in_kind_govt_trf inc_of_hh_frm_ngo_trf, by(state district year mnth date_flag)

save "$output\Inc exp flood\income_cleaned.dta", replace




//Keep only for bihar and up and for the months needed for expenditure//
use "$cphs\Expenditure\DTA_exp\all_exp_appended.dta", clear
gen year = substr(month, 5,.)
destring year, replace
gen mnth = substr(month,1,3)
drop month
gen month=.
replace month = 1 if mnth == "Jan" 
replace month = 2 if mnth == "Feb" 
replace month = 3 if mnth == "Mar" 
replace month = 4 if mnth == "Apr" 
replace month = 5 if mnth == "May" 
replace month = 6 if mnth == "Jun" 
replace month = 7 if mnth == "Jul" 
replace month = 8 if mnth == "Aug" 
replace month = 9 if mnth == "Sep" 
replace month = 10 if mnth == "Oct" 
replace month = 11 if mnth == "Nov" 
replace month = 12 if mnth == "Dec" 
rename mnth Month 
*tostring year month, replace
gen mnth = ym(year, month)
gen date_flag = mnth
format mnth %tmMon

foreach var in tot_exp adj_tot_exp m_exp_food adj_m_exp_food m_exp_cereals_n_pulses m_exp_cereals_wholegrain m_exp_processed_cereals_n_pulses m_exp_pulses m_exp_edible_oils adj_m_exp_edible_oils m_exp_dry_spices m_exp_veggie_n_fruits adj_m_exp_veggie_n_fruits m_exp_veggie_n_wet_spices adj_m_exp_veggie_n_wet_spices m_exp_fruits adj_m_exp_fruits m_exp_potatoes_n_onions adj_m_exp_potatoes_n_onions m_exp_milk_n_milk_prds adj_m_exp_milk_n_milk_prds m_exp_milk_n_milk_powder adj_m_exp_milk_n_milk_powder m_exp_milk_prds adj_m_exp_milk_prds m_exp_bread adj_m_exp_bread m_exp_biscuits adj_m_exp_biscuits m_exp_salty_snacks adj_m_exp_salty_snacks m_exp_noodles_n_flakes m_exp_noodles_n_pasta m_exp_flakes_muesli_n_oats m_exp_choclate_cake_icecream adj_m_exp_choclate_cake_icecream m_exp_choclates_n_cakes adj_m_exp_choclates_n_cakes m_exp_ice_creams adj_m_exp_ice_creams m_exp_jam_ketchup_pickles m_exp_health_supplements m_exp_meat_eggs_n_fish adj_m_exp_meat_eggs_n_fish m_exp_ready_to_eat_food m_exp_tea_coffee m_exp_tea m_exp_coffee m_exp_sugar_n_oth_sweeteners m_exp_beverages_n_water adj_m_exp_beverages_n_water m_exp_soft_drinks m_exp_bottled_water adj_m_exp_bottled_water m_exp_juices m_exp_juices_jams m_exp_baby_food m_exp_oth_foods m_exp_intoxicants adj_m_exp_intoxicants m_exp_cigarettes_n_tobacco adj_m_exp_cigarettes_n_tobacco m_exp_cigarettes adj_m_exp_cigarettes m_exp_bidis adj_m_exp_bidis m_exp_oth_tobacco_prds adj_m_exp_oth_tobacco_prds m_exp_liquor m_exp_clothing_n_footwear m_exp_clothing m_exp_footwear m_exp_clothing_accessories m_exp_cosmetic_n_toiletries m_exp_dental_care_prds m_exp_toothpaste m_exp_toothpowder m_exp_toothbrush m_exp_bathing_soap m_exp_cosmetics m_exp_face_wash m_exp_shaving_articles m_exp_hair_oil m_exp_shampoo_n_conditioner m_exp_powder m_exp_creams m_exp_deodorants_n_perfumes m_exp_all_types_of_detergent m_exp_detergent_bars m_exp_detergent_liquids_n_powder m_exp_scourers m_exp_oth_housecare_prds m_exp_appliances m_exp_kitchen_appliances m_exp_hh_appliances m_exp_restaurants adj_m_exp_restaurants m_exp_food_in_restaurants adj_m_exp_food_in_restaurants m_exp_liquor_in_restaurants m_exp_recreation m_exp_e_storage_devices m_exp_entmt m_exp_toys m_exp_bills_n_rent m_exp_house_rent m_exp_water_charges m_exp_society_charges m_exp_oth_taxes m_exp_power_n_fuel adj_m_exp_power_n_fuel m_exp_cooking_fuel m_exp_petrol_n_diesel adj_m_exp_petrol_n_diesel m_exp_petrol_n_cng adj_m_exp_petrol_n_cng m_exp_diesel adj_m_exp_diesel m_exp_electricity m_exp_transport adj_m_exp_transport m_exp_bus_train_n_ferry m_exp_outstation_taxi_bus_train m_exp_autorickshaw_n_cab adj_m_exp_autorickshaw_n_cab m_exp_airfare m_exp_communication_n_info m_exp_landline_phone m_exp_cell_phone m_exp_cable_tv m_exp_internet m_exp_newspapers_n_magazines m_exp_edu m_exp_books_journals m_exp_stationery m_exp_school_college_fees m_exp_pvt_tuition_fees m_exp_hobby_classes m_exp_additional_prof_edu m_exp_overseas_edu m_exp_oth_edu m_exp_health m_exp_medicines m_exp_doctors_physio_fee m_exp_medical_tests m_exp_hospitalisation_fees m_exp_health_ins_premium m_exp_health_enhancement m_exp_health_serv m_exp_health_oth m_exp_oth_beauty_n_hygiene_prds m_exp_all_emis m_exp_emi_for_house m_exp_emi_for_vehicle m_exp_emi_for_durables m_exp_oth_emis m_exp_misc m_exp_domestic_help m_exp_motor_vehicle_repairs m_exp_remittances_sent m_exp_social_obligations m_exp_religious_obligations m_exp_general_ins m_exp_vacation m_exp_lighting m_exp_furniture_n_furnishings m_exp_painting_n_renovation m_exp_utensils m_exp_pocket_money m_exp_pets m_exp_ghee m_exp_dry_fruits_n_saffron m_exp_mithai adj_m_exp_mithai m_exp_meat_n_fish adj_m_exp_meat_n_fish m_exp_eggs adj_m_exp_eggs m_exp_beverages m_exp_artificial_jewellery m_exp_bag_wallet_watch_glasses m_exp_gems_n_jewellery m_exp_oth_hair_cosmetics m_exp_oth_cosmetics m_exp_mobiles_n_accessories m_exp_school_academic_books m_exp_fiction_non_fiction_books m_exp_school_transport m_exp_hygiene_prds m_exp_fitness m_exp_parlor_spa m_exp_prof_consultation m_exp_parking_fees m_exp_toll_charges m_exp_specs_lense_n_oth_med_aid m_exp_batteries m_exp_meat adj_m_exp_meat m_exp_fish adj_m_exp_fish m_exp_ott m_exp_tooth_brush_n_paste m_exp_bathing_soap_n_face_wash m_exp_handwash_n_sanitiser m_exp_detergent m_exp_utensil_cleaning_agents m_exp_house_cleaning_agents m_exp_parking_fees_toll_charges m_exp_internet_n_landline m_exp_diapers m_exp_sanitary_napkins m_exp_domestic_help_n_laundary m_exp_creche_daycare_children m_exp_housenurse_daycare_aged m_exp_lighting_n_furnishings{
	replace `var' = . if `var'<0
}


collapse (sum) tot_exp adj_tot_exp m_exp_food adj_m_exp_food m_exp_cereals_n_pulses m_exp_cereals_wholegrain m_exp_processed_cereals_n_pulses m_exp_pulses m_exp_edible_oils adj_m_exp_edible_oils m_exp_dry_spices m_exp_veggie_n_fruits adj_m_exp_veggie_n_fruits m_exp_veggie_n_wet_spices adj_m_exp_veggie_n_wet_spices m_exp_fruits adj_m_exp_fruits m_exp_potatoes_n_onions adj_m_exp_potatoes_n_onions m_exp_milk_n_milk_prds adj_m_exp_milk_n_milk_prds m_exp_milk_n_milk_powder adj_m_exp_milk_n_milk_powder m_exp_milk_prds adj_m_exp_milk_prds m_exp_bread adj_m_exp_bread m_exp_biscuits adj_m_exp_biscuits m_exp_salty_snacks adj_m_exp_salty_snacks m_exp_noodles_n_flakes m_exp_noodles_n_pasta m_exp_flakes_muesli_n_oats m_exp_choclate_cake_icecream adj_m_exp_choclate_cake_icecream m_exp_choclates_n_cakes adj_m_exp_choclates_n_cakes m_exp_ice_creams adj_m_exp_ice_creams m_exp_jam_ketchup_pickles m_exp_health_supplements m_exp_meat_eggs_n_fish adj_m_exp_meat_eggs_n_fish m_exp_ready_to_eat_food m_exp_tea_coffee m_exp_tea m_exp_coffee m_exp_sugar_n_oth_sweeteners m_exp_beverages_n_water adj_m_exp_beverages_n_water m_exp_soft_drinks m_exp_bottled_water adj_m_exp_bottled_water m_exp_juices m_exp_juices_jams m_exp_baby_food m_exp_oth_foods m_exp_intoxicants adj_m_exp_intoxicants m_exp_cigarettes_n_tobacco adj_m_exp_cigarettes_n_tobacco m_exp_cigarettes adj_m_exp_cigarettes m_exp_bidis adj_m_exp_bidis m_exp_oth_tobacco_prds adj_m_exp_oth_tobacco_prds m_exp_liquor m_exp_clothing_n_footwear m_exp_clothing m_exp_footwear m_exp_clothing_accessories m_exp_cosmetic_n_toiletries m_exp_dental_care_prds m_exp_toothpaste m_exp_toothpowder m_exp_toothbrush m_exp_bathing_soap m_exp_cosmetics m_exp_face_wash m_exp_shaving_articles m_exp_hair_oil m_exp_shampoo_n_conditioner m_exp_powder m_exp_creams m_exp_deodorants_n_perfumes m_exp_all_types_of_detergent m_exp_detergent_bars m_exp_detergent_liquids_n_powder m_exp_scourers m_exp_oth_housecare_prds m_exp_appliances m_exp_kitchen_appliances m_exp_hh_appliances m_exp_restaurants adj_m_exp_restaurants m_exp_food_in_restaurants adj_m_exp_food_in_restaurants m_exp_liquor_in_restaurants m_exp_recreation m_exp_e_storage_devices m_exp_entmt m_exp_toys m_exp_bills_n_rent m_exp_house_rent m_exp_water_charges m_exp_society_charges m_exp_oth_taxes m_exp_power_n_fuel adj_m_exp_power_n_fuel m_exp_cooking_fuel m_exp_petrol_n_diesel adj_m_exp_petrol_n_diesel m_exp_petrol_n_cng adj_m_exp_petrol_n_cng m_exp_diesel adj_m_exp_diesel m_exp_electricity m_exp_transport adj_m_exp_transport m_exp_bus_train_n_ferry m_exp_outstation_taxi_bus_train m_exp_autorickshaw_n_cab adj_m_exp_autorickshaw_n_cab m_exp_airfare m_exp_communication_n_info m_exp_landline_phone m_exp_cell_phone m_exp_cable_tv m_exp_internet m_exp_newspapers_n_magazines m_exp_edu m_exp_books_journals m_exp_stationery m_exp_school_college_fees m_exp_pvt_tuition_fees m_exp_hobby_classes m_exp_additional_prof_edu m_exp_overseas_edu m_exp_oth_edu m_exp_health m_exp_medicines m_exp_doctors_physio_fee m_exp_medical_tests m_exp_hospitalisation_fees m_exp_health_ins_premium m_exp_health_enhancement m_exp_health_serv m_exp_health_oth m_exp_oth_beauty_n_hygiene_prds m_exp_all_emis m_exp_emi_for_house m_exp_emi_for_vehicle m_exp_emi_for_durables m_exp_oth_emis m_exp_misc m_exp_domestic_help m_exp_motor_vehicle_repairs m_exp_remittances_sent m_exp_social_obligations m_exp_religious_obligations m_exp_general_ins m_exp_vacation m_exp_lighting m_exp_furniture_n_furnishings m_exp_painting_n_renovation m_exp_utensils m_exp_pocket_money m_exp_pets m_exp_ghee m_exp_dry_fruits_n_saffron m_exp_mithai adj_m_exp_mithai m_exp_meat_n_fish adj_m_exp_meat_n_fish m_exp_eggs adj_m_exp_eggs m_exp_beverages m_exp_artificial_jewellery m_exp_bag_wallet_watch_glasses m_exp_gems_n_jewellery m_exp_oth_hair_cosmetics m_exp_oth_cosmetics m_exp_mobiles_n_accessories m_exp_school_academic_books m_exp_fiction_non_fiction_books m_exp_school_transport m_exp_hygiene_prds m_exp_fitness m_exp_parlor_spa m_exp_prof_consultation m_exp_parking_fees m_exp_toll_charges m_exp_specs_lense_n_oth_med_aid m_exp_batteries m_exp_meat adj_m_exp_meat m_exp_fish adj_m_exp_fish m_exp_ott m_exp_tooth_brush_n_paste m_exp_bathing_soap_n_face_wash m_exp_handwash_n_sanitiser m_exp_detergent m_exp_utensil_cleaning_agents m_exp_house_cleaning_agents m_exp_parking_fees_toll_charges m_exp_internet_n_landline m_exp_diapers m_exp_sanitary_napkins m_exp_domestic_help_n_laundary m_exp_creche_daycare_children m_exp_housenurse_daycare_aged m_exp_lighting_n_furnishings, by(state district year mnth date_flag)

save "$output\Inc exp flood\expenditure_cleaned.dta", replace















